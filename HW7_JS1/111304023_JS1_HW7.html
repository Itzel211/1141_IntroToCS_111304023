<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>StudentID_HW6_1A2B</title>
</head>
<body>

  <h1>StudentID_HW6_1A2B</h1>

  <input id="userInput" type="text" placeholder="輸入4位數">
  <button onclick="play()">Guess</button>

  <div id="record">
    <br>猜測紀錄：<br>
  </div>

  <script>
    // =============================
    // 產生不重複的 4 位數答案
    // =============================
    function generateAnswer() {
      let digits = [0,1,2,3,4,5,6,7,8,9];
      let ans = "";

      while (ans.length < 4) {
        let idx = Math.floor(Math.random() * digits.length);
        ans += digits[idx];
        digits.splice(idx, 1);
      }
      return ans;
    }

    let answer = generateAnswer();
    let count = 0;

    console.log("Debug Answer = " + answer); // 交作業前可移除

    // =============================
    // 驗證輸入
    // =============================
    function isValid(str) {
      if (str.length !== 4) return false;
      if (!/^\d{4}$/.test(str)) return false;

      let set = new Set(str.split(""));
      if (set.size !== 4) return false;

      return true;
    }

    // =============================
    // 計算 A / B
    // =============================
    function checkAB(guess, ans) {
      let A = 0;
      let B = 0;

      for (let i = 0; i < 4; i++) {
        if (guess[i] === ans[i]) {
          A++;
        } else if (ans.includes(guess[i])) {
          B++;
        }
      }
      return `${A}A${B}B`;
    }

    // =============================
    // 主遊戲流程
    // =============================
    function play() {
      let inputField = document.getElementById("userInput");
      let guess = inputField.value.trim();

      if (!isValid(guess)) {
        alert("輸入錯誤！請輸入 4 位不重複的數字。");
        return;
      }

      count++;

      let result = checkAB(guess, answer);

      document.getElementById("record").innerHTML +=
        count + ". " + guess + " → " + result + "<br>";

      if (result === "4A0B") {
        alert("恭喜答對！你總共猜了 " + count + " 次。");
      }

      inputField.value = "";
      inputField.focus();
    }
  </script>

</body>
</html>
